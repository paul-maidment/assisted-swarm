registry: quay.io
build-container-image: assisted-swarm-build

volumes:
  # cache
  - $HOME/.cache/go-build:/go/pkg/mod
  # Registry credentials
  - $HOME/.docker/:$HOME/.docker
  # Podman socket for podman-remote
  - $(podman info --format "{{.Host.RemoteSocket.Path}}" 2> /dev/null || echo "$XDG_RUNTIME_DIR/podman/podman.sock"):/run/podman/podman.sock

containers:
  assisted-swarm-build: Dockerfile.assisted-swarm-build
env_file:
  - skipper.env
env:
  GOCACHE: "/go/pkg/mod"
  CONTAINER_HOST: unix://run/podman/podman.sock
